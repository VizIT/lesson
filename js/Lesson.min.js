/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};window.vizit.lesson.utility=window.vizit.lesson.utility||{};(function(g){g.IdRegistry=function(){var c;c={};this.getIdFor=function(h){c.hasOwnProperty(h)||(c[h]=0);return++c[h]}};g.idRegistry=new g.IdRegistry})(window.vizit.lesson.utility);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(g){g.CUSTOM_EVENT="CustomEvent";g.ValueOutputHandler=function(c,h){var d,e;this.handleEvent=function(b){e.value=d.value};d=c;e=h};g.XChangedEventHandler=function(c,h){var d,e;this.emitEvent=function(){var b,a;a={source:d.id,name:e,value:d.value};b=document.createEvent(g.CUSTOM_EVENT);b.initCustomEvent(e+"Changed",!0,!0,a);d.dispatchEvent(b)};this.handleEvent=function(b){b=b.detail;b.source!=d.id&&(d.value=b.value,b=document.createEvent("HTMLEvents"),b.initEvent("change",!1,!0),d.dispatchEvent(b))};
d=c;e=h};g.RangedSource=function(c){var h,d,e,b,a,k,f;e=c.getAttribute("data-name");a=c.getAttribute("data-max");b=c.getAttribute("data-min");k=c.getAttribute("data-step");f=c.getAttribute("data-value");h=e+"_"+this.getIdFor(e);"undefined"===typeof f&&(f=c.innerHTML);c.classList.add("lessonRangedSource");c.textContent="";d=document.createElement("input");d.setAttribute("class","lessonRangedSource");d.setAttribute("type","range");d.setAttribute("value",f);d.setAttribute("min",b);d.setAttribute("max",
a);d.setAttribute("step",k);d.setAttribute("id","rinput_"+h);b=document.createElement("output");b.setAttribute("id","routput_"+h);b.setAttribute("for","rinput_"+h);h=document.createTextNode(f);b.appendChild(h);c.appendChild(b);c.appendChild(d);c=new g.ValueOutputHandler(d,b);d.addEventListener("input",c.handleEvent.bind(c));d.addEventListener("change",c.handleEvent.bind(c));c=new g.XChangedEventHandler(d,e);d.addEventListener("input",c.emitEvent.bind(c));document.addEventListener(e+"Changed",c.handleEvent.bind(c))};
g.RangedSource.prototype=g.utility.idRegistry})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.LessonBuilder=function(){this.init=function(){var c,h,d;h=document.getElementsByClassName("lessonElement");for(var e=h.length;e--;)c=h[e],d=c.getAttribute("data-type"),"rangedsource"===d.toLowerCase()&&new g.RangedSource(c)};this.initWhenReady=function(){"interactive"===document.readyState||"complete"===document.readyState?this.init():document.addEventListener("DOMContentLoaded",this.findElements,!1)}};(new g.LessonBuilder).initWhenReady()})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.MappingEventHandler=function(c,h,d,e){var b,a,k;this.handleUpdate=function(f){k(a(f.detail.value));b.requestRender()};a=new Function(h,"return "+d+";");b=framework_l;k=c}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.DirectEventHandler=function(c,h){var d,e;this.handleUpdate=function(b){d(b.detail.value);e.requestRender()};d=c;e=h}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.GaussianSurfaceRChangedEventListiner=function(c,h){this.handleRChanged=function(d){c.setRadius(d.detail.value);h.render()};this.handleHChanged=function(d){c.setHeight(d.detail.value);h.render()}}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(g){g.LessonContentEventHandler=function(c,h){var d;this.handleEvent=function(c){var b,a,k,f;c=c.detail;a=document.getElementsByClassName(d);var q=0;for(k=a.length;q<k;++q)b=a[q],c.source!=b.id&&(f=c.value,b.innerHTML=10>f?"&nbsp;"+f.toFixed(2):f.toFixed(2))};d=h;document.addEventListener(c,this.handleEvent.bind(this),!1)};g.MappingContentEventHandler=function(c,h,d){var e,b;this.handleEvent=function(a){var k,f,d,c;a=a.detail;f=document.getElementsByClassName(e);var h=0;for(d=f.length;h<
d;++h)k=f[h],a.source!=k.id&&(c=b(a.value),k.innerHTML=10>c?"&nbsp;"+c.toFixed(2):c.toFixed(2))};e=d;b=h;document.addEventListener(c,this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.LessonContentIDEventSource=function(c,h){var d,e;this.handleEvent=function(k){var f,a;k.preventDefault();if(f=this.id)a=f.split("="),1<a.length&&(k=document.createEvent(d),k.initCustomEvent(a[0]+"Changed",!0,!0,{value:parseInt(a[1],10),source:f}),this.dispatchEvent(k))};d="CustomEvent";e=document.getElementsByClassName(h);for(var b=0,a=e.length;b<a;b++)e[b].addEventListener(c,this.handleEvent,!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(g){g.LessonControlEventHandler=function(c,h){var d,e,b,a;d=[];e=!1;a=c.getID();b=h.createSVGPoint();this.toSVGCoordinates=function(a,f){b.x=f.clientX;b.y=f.clientY;return b.matrixTransform(a.getScreenCTM().inverse())};this.findTouchByIdentifier=function(a){var f,c;for(f=0;f<d.length;f++)if(c=d[f].identifier,c==a)return f;return-1};this.handleTouchStart=function(a){var f,b,e;e=a.targetTouches;0==d.length&&1==e.length&&c.setScreenX(this.toSVGCoordinates(h,e[0]).x);for(f=0;f<e.length;f++)b=
e[f],-1==this.findTouchByIdentifier(b.identifier)&&d.push(b);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchEnd=function(a){var f,c,b;b=a.changedTouches;for(f=0;f<b.length;f++)c=this.findTouchByIdentifier(b[f].identifier),-1!=c&&(d.splice(c,1),a.preventDefault())};this.handleOneActiveMove=function(a){var f;f=a.changedTouches[0];null!=d[0]?d.splice(0,1,f):d.push(f);c.setScreenX(this.toSVGCoordinates(h,f).x);if(a.preventDefault)a.preventDefault();else return!1};this.handleTwoActiveMove=
function(a){var f,b,e,h,g,l,m;h=d[0];l=d[1];f=l.pageX-h.pageX;b=l.pageY-h.pageY;e=Math.sqrt(f*f+b*b);m=a.changedTouches;for(f=0;f<m.length;f++)g=m[f],b=g.identifier,h.identifier==b?(h=g,d.splice(0,1,g)):l.identifier==b&&(l=g,d.splice(1,1,g));f=l.pageX-h.pageX;b=l.pageY-h.pageY;h=Math.sqrt(f*f+b*b);c.zoomBy(h/e);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchMove=function(a){return 1==d.length?this.handleOneActiveMove(a):2==d.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=
function(a){e=!0;this.handleMouseMove(a)};this.handleMouseUp=function(a){e=!1};this.handleMouseMove=function(a){e&&c.setScreenX(this.toSVGCoordinates(h,a).x)};this.handleMouseWheel=function(a){var b;a=window.event||a;b=a.deltaY?-a.deltaY:a.wheelDeltaY;c.zoomBy(0<b?2:0.5);if(a.preventDefault)a.preventDefault();else return!1};this.handleXChanged=function(b){b=b.detail;b.source!=a&&c.setX(b.value)}}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.ModelImageEventHandler=function(c,h,d){var e,b,a;this.handleEvent=function(c){var d;d=c.detail.value;c=0;for(nvalues=a.length;c<nvalues&&!(a[c]>d);++c);e.src=b[c]};e=c;b=[];a=[];c=0;for(var g=d.length;c<g;c++)0==c%2?b.push(d[c]):a.push(d[c]);document.addEventListener(h+"Changed",this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.RadialDependancyAdaptor=function(c,h,d,e,b,a){var g,f,q,p,s,n,l,m;this.f=function(a){var b;0==a&&(a=1E-10);b=a*p;a=g.getField(n+b*q,l+b*f,m+a*s);return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])};g=c;n=h;l=d;m=e;f=Math.sin(b);q=Math.cos(b);p=Math.sin(a);s=Math.cos(a)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.DotRAdapter=function(c,h,d,e,b,a){var g,f,q,p,s,n,l,m,r,u,v;this.f=function(a){var b;0==a&&(a=1E-10);b=a*p;a=g.getField(r+b*q,u+b*f,v+a*s);return a[0]*n+a[1]*l+a[2]*m};g=c;r=h;u=d;v=e;f=Math.sin(b);q=Math.cos(b);p=Math.sin(a);s=Math.cos(a);n=q*p;l=f*p;m=s}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(g){g.SurfaceExtensionEventListiner=function(c,h){var d,e,b,a,g,f,q,p;this.handleHChanged=function(c){var d,e;e=p.getOrigin();d=p.getHeight();c=(c.detail.value-(e[0]+d*a*g/2))/(a*g);e[0]+=c*a*g/2;e[1]+=c*b*g/2;e[2]+=c*f/2;p.setHeight(d+c);p.setOrigin(e);q.render()};q=h;p=c;d=p.getPhi();e=p.getTheta();b=Math.sin(d);a=Math.cos(d);g=Math.sin(e);f=Math.cos(e)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(g){g.ModelExpressionEventHandler=function(c,g){var d,e,b,a,k;this.handleEvent=function(b){var c,f;f=b.detail.value;b=0;for(c=a.length;b<c&&!(a[b]>f);++b);MathJax.Hub.Queue(["Text",d,e[b]])};MathJax.Hub.queue.Push(function(){d=MathJax.Hub.getAllJax(c)[0]});d=c;e=[];b=Array.prototype.slice.call(arguments,2);a=[];k=g;for(var f=0,q=b.length;f<q;f++)0==f%2?e.push(b[f]):a.push(b[f]);document.addEventListener(k+"Changed",this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(g){g.XvsYView=function(c,h,d,e,b,a,k,f){var q,p,s,n,l,m,r,u,v,A,w,x,t,y,z,B;q=0.1;m=d;r=e;A=1E3/(r-m);x=a;t=k;B=1E3/(t-x);this.getID=function(){return f.id};this.mapXToScreen=function(a){return(a-m)*A};this.mapScreenToX=function(a){return a/A+m};this.mapRawToGroupX=function(a){return a-50};this.mapYToScreen=function(a){a>t?a=t+10:a<x&&(a=x-10);return 1E3-(a-x)*B};this.createPointer=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","use");c.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#pointer");c.setAttributeNS(null,"x",a);c.setAttributeNS(null,"y",b);return c};this.dispatchXChangedEvent=function(){var a;a=document.createEvent("CustomEvent");a.initCustomEvent(h+"Changed",!0,!0,{value:l,source:f.id});f.dispatchEvent(a)};this.setX=function(a){this.x=a;a>=m&&a<=r&&(w=c.f(a),s.x.baseVal.value=this.mapXToScreen(a),s.y.baseVal.value=this.mapYToScreen(w))};this.setScreenX=function(a){a=this.mapRawToGroupX(a);l=this.mapScreenToX(a);l>m&&l<r&&(w=c.f(l),w=this.mapYToScreen(w),s.x.baseVal.value=
a,s.y.baseVal.value=w,this.dispatchXChangedEvent())};this.computePoints=function(){var a,b;n="";for(a=m;a<r;a+=q)b=c.f(a),n+=this.mapXToScreen(a),n+=",",n+=this.mapYToScreen(b),n+=" ";return n=n.substring(0,n.length-1)};this.zoomBy=function(a){var b;m*=a;r*=a;x*=a;t*=a;v.textContent=r.toFixed(2);b=(m+r)/2;u.textContent=b.toFixed(2);z.textContent=t.toFixed(2);b=(x+t)/2;y.textContent=b.toFixed(2);A=1E3/(r-m);B=1E3/(t-x);q*=a;n=this.computePoints();p.setAttributeNS(null,"points",n);l=Math.min(r,Math.max(m,
l));this.setX(l);this.dispatchXChangedEvent()};d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(50,20)");e=document.createElementNS("http://www.w3.org/2000/svg","defs");a=document.createElementNS("http://www.w3.org/2000/svg","clipPath");a.setAttributeNS(null,"id","plotClip");k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttributeNS(null,"x",0);k.setAttributeNS(null,"y",0);k.setAttributeNS(null,"height",1E3);k.setAttributeNS(null,
"width",1E3);a.appendChild(k);e.appendChild(a);k=document.createElementNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"id","pointer");a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttributeNS(null,"cx",0);a.setAttributeNS(null,"cy",0);a.setAttributeNS(null,"r",12);a.setAttributeNS(null,"class","rPointer");k.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttributeNS(null,"cx",0);a.setAttributeNS(null,"cy",0);a.setAttributeNS(null,
"r",5);a.setAttributeNS(null,"class","rPointer");k.appendChild(a);e.appendChild(k);f.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"stroke-width",5);e.setAttributeNS(null,"stroke","black");a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 1000 L 1000 1000 Z");k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M 0 0 L 0 1000 Z");e.appendChild(k);e.appendChild(a);
d.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"class","markers");a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 0 L 1000 0 Z");e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 500 L 1000 500 Z");e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 1000 0 L 1000 1000 Z");e.appendChild(a);
a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 500 0 L 500 1000 Z");e.appendChild(a);z=document.createElementNS("http://www.w3.org/2000/svg","text");z.setAttributeNS(null,"x","-10");z.setAttributeNS(null,"y","10");z.setAttributeNS(null,"class","axisLabel");z.appendChild(document.createTextNode(t));e.appendChild(z);y=document.createElementNS("http://www.w3.org/2000/svg","text");y.setAttributeNS(null,"x","-10");y.setAttributeNS(null,"y","510");y.setAttributeNS(null,
"class","axisLabel");y.appendChild(document.createTextNode((x+t)/2));e.appendChild(y);u=document.createElementNS("http://www.w3.org/2000/svg","text");u.setAttributeNS(null,"x","510");u.setAttributeNS(null,"y","1030");u.setAttributeNS(null,"class","axisLabel");u.appendChild(document.createTextNode((m+r)/2));e.appendChild(u);v=document.createElementNS("http://www.w3.org/2000/svg","text");v.setAttributeNS(null,"x","1010");v.setAttributeNS(null,"y","1030");v.setAttributeNS(null,"class","axisLabel");v.appendChild(document.createTextNode(r));
e.appendChild(v);a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttributeNS(null,"x","-50");a.setAttributeNS(null,"y","510");a.setAttributeNS(null,"transform","rotate(-90 -50,510)");a.setAttributeNS(null,"class","axisLabel");a.appendChild(document.createTextNode(b));e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttributeNS(null,"x","510");a.setAttributeNS(null,"y","1055");a.setAttributeNS(null,"class","axisLabel");a.appendChild(document.createTextNode(h));
e.appendChild(a);n=this.computePoints();p=document.createElementNS("http://www.w3.org/2000/svg","polyline");p.setAttributeNS(null,"class","curve");p.setAttributeNS(null,"points",n);l=15;w=c.f(l);l=this.mapXToScreen(l);w=this.mapYToScreen(w);s=this.createPointer(l,w);d.appendChild(e);d.appendChild(p);d.appendChild(s);f.appendChild(d);b=new g.LessonControlEventHandler(this,f);f.addEventListener("mousewheel",b.handleMouseWheel.bind(b),!1);f.addEventListener("wheel",b.handleMouseWheel.bind(b),!1);f.addEventListener("mousedown",
b.handleMouseDown.bind(b),!1);document.addEventListener("mouseup",b.handleMouseUp.bind(b),!1);document.addEventListener("mousemove",b.handleMouseMove.bind(b),!1);f.addEventListener("touchstart",b.handleTouchStart.bind(b),!1);f.addEventListener("touchmove",b.handleTouchMove.bind(b),!1);document.addEventListener("touchend",b.handleTouchEnd.bind(b),!1);document.addEventListener(h+"Changed",b.handleXChanged.bind(b),!1)}})(window.vizit.lesson);
