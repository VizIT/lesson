/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};window.vizit.lesson.utility=window.vizit.lesson.utility||{};(function(f){f.IdRegistry=function(){var c;c={};this.getIdFor=function(g){c.hasOwnProperty(g)||(c[g]=0);return++c[g]}};f.idRegistry=new f.IdRegistry})(window.vizit.lesson.utility);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.CUSTOM_EVENT="CustomEvent";f.ValueOutputHandler=function(c,g){var d,e;this.handleEvent=function(b){e.value=d.value};d=c;e=g};f.XChangedEventHandler=function(c,g){var d,e;this.emitEvent=function(){var b,a;a={source:d.id,name:e,value:d.value};b=document.createEvent(f.CUSTOM_EVENT);b.initCustomEvent(e+"Changed",!0,!0,a);d.dispatchEvent(b)};this.handleEvent=function(b){b=b.detail;b.source!=d.id&&(d.value=b.value,b=document.createEvent("HTMLEvents"),b.initEvent("change",!1,!0),d.dispatchEvent(b))};
d=c;e=g};f.RangedSource=function(c){var g,d,e,b,a,h,k;e=c.getAttribute("data-name");a=c.getAttribute("data-max");b=c.getAttribute("data-min");h=c.getAttribute("data-step");g=e+"_"+this.getIdFor(e);k=c.hasAttribute("data-value")?c.getAttribute("data-value"):c.innerHTML;c.classList.add("lessonRangedSource");c.textContent="";d=document.createElement("input");d.setAttribute("class","lessonRangedSource");d.setAttribute("type","range");d.setAttribute("value",k);d.setAttribute("min",b);d.setAttribute("max",
a);d.setAttribute("step",h);d.setAttribute("id","rinput_"+g);b=document.createElement("output");b.setAttribute("id","routput_"+g);b.setAttribute("for","rinput_"+g);g=document.createTextNode(k);b.appendChild(g);c.appendChild(b);c.appendChild(d);c=new f.ValueOutputHandler(d,b);d.addEventListener("input",c.handleEvent.bind(c));d.addEventListener("change",c.handleEvent.bind(c));c=new f.XChangedEventHandler(d,e);d.addEventListener("input",c.emitEvent.bind(c));document.addEventListener(e+"Changed",c.handleEvent.bind(c))};
f.RangedSource.prototype=f.utility.idRegistry})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.CUSTOM_EVENT="CustomEvent";f.Setter=function(c){var g,d,e;this.handleEvent=function(b){var a,h;b.preventDefault();h=e.length;for(a=0;a<h;++a)b=document.createEvent(f.CUSTOM_EVENT),b.initCustomEvent(e[a]+"Changed",!0,!0,{value:d[a],source:"setter"}),g.dispatchEvent(b)};this.init=function(b){var a,h,k,c,l,f;d=[];e=[];f="click";h=b.getAttribute("data-desc");k=b.getAttribute("data-set");b.hasAttribute("data-trigger")&&(f=b.getAttribute("data-trigger"));b.hasAttribute("data-html")&&(a=b.getAttribute("data-html"));
c=k.split(",");for(k=c.length-1;0<=k;--k)l=c[k].split("="),e.push(l[0].trim()),d.push(l[1].trim());h&&(g=document.createElement("abbr"),g.setAttribute("title",h));l=document.createElement("a");l.setAttribute("href","#");l.setAttribute("class","setter");if("undefined"!=typeof a)for(l.innerHTML=a;b.firstChild;)b.removeChild(b.firstChild);g?g.appendChild(l):g=l;b.insertBefore(g,b.firstChild);b.addEventListener(f,this.handleEvent.bind(this),!1)};this.init(c)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.SurfaceExtensionEventListiner=function(c,g){var d,e,b,a,h,k,f,l;this.handleHChanged=function(d){var c,e;e=l.getOrigin();c=l.getHeight();d=(d.detail.value-(e[0]+c*a*h/2))/(a*h);e[0]+=d*a*h/2;e[1]+=d*b*h/2;e[2]+=d*k/2;l.setHeight(c+d);l.setOrigin(e);f.render()};f=g;l=c;d=l.getPhi();e=l.getTheta();b=Math.sin(d);a=Math.cos(d);h=Math.sin(e);k=Math.cos(e)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.MappingEventHandler=function(c,g,d,e){var b,a,h;this.handleUpdate=function(d){h(a(d.detail.value));b.requestRender()};a=new Function(g,"return "+d+";");b=framework_l;h=c}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.DirectEventHandler=function(c,g){var d,e;this.handleUpdate=function(b){d(b.detail.value);e.requestRender()};d=c;e=g}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.GaussianSurfaceRChangedEventListiner=function(c,g){this.handleRChanged=function(d){c.setRadius(d.detail.value);g.render()};this.handleHChanged=function(d){c.setHeight(d.detail.value);g.render()}}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.LessonContentEventHandler=function(c,g){var d;this.handleEvent=function(e){var b,a,h,k;e=e.detail;a=document.getElementsByClassName(d);var c=0;for(h=a.length;c<h;++c)b=a[c],e.source!=b.id&&(k=e.value,b.innerHTML=10>k?"&nbsp;"+k.toFixed(2):k.toFixed(2))};d=g;document.addEventListener(c,this.handleEvent.bind(this),!1)};f.MappingContentEventHandler=function(c,g,d){var e,b;this.handleEvent=function(d){var h,k,c,g;d=d.detail;k=document.getElementsByClassName(e);var f=0;for(c=k.length;f<
c;++f)h=k[f],d.source!=h.id&&(g=b(d.value),h.innerHTML=10>g?"&nbsp;"+g.toFixed(2):g.toFixed(2))};e=d;b=g;document.addEventListener(c,this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.LessonContentIDEventSource=function(c,g){var d,e;this.handleEvent=function(b){var c,a;b.preventDefault();if(c=this.id)a=c.split("="),1<a.length&&(b=document.createEvent(d),b.initCustomEvent(a[0]+"Changed",!0,!0,{value:parseInt(a[1],10),source:c}),this.dispatchEvent(b))};d="CustomEvent";e=document.getElementsByClassName(g);for(var b=0,a=e.length;b<a;b++)e[b].addEventListener(c,this.handleEvent,!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.LessonControlEventHandler=function(c,g){var d,e,b,a;d=[];e=!1;a=c.getID();b=g.createSVGPoint();this.toSVGCoordinates=function(d,c){b.x=c.clientX;b.y=c.clientY;return b.matrixTransform(d.getScreenCTM().inverse())};this.findTouchByIdentifier=function(b){var c,a;for(c=0;c<d.length;c++)if(a=d[c].identifier,a==b)return c;return-1};this.handleTouchStart=function(b){var a,e,f;f=b.targetTouches;0==d.length&&1==f.length&&c.setScreenX(this.toSVGCoordinates(g,f[0]).x);for(a=0;a<f.length;a++)e=
f[a],-1==this.findTouchByIdentifier(e.identifier)&&d.push(e);if(b.preventDefault)b.preventDefault();else return!1};this.handleTouchEnd=function(b){var c,a,e;e=b.changedTouches;for(c=0;c<e.length;c++)a=this.findTouchByIdentifier(e[c].identifier),-1!=a&&(d.splice(a,1),b.preventDefault())};this.handleOneActiveMove=function(b){var a;a=b.changedTouches[0];null!=d[0]?d.splice(0,1,a):d.push(a);c.setScreenX(this.toSVGCoordinates(g,a).x);if(b.preventDefault)b.preventDefault();else return!1};this.handleTwoActiveMove=
function(b){var a,e,f,g,m,n,p;g=d[0];n=d[1];a=n.pageX-g.pageX;e=n.pageY-g.pageY;f=Math.sqrt(a*a+e*e);p=b.changedTouches;for(a=0;a<p.length;a++)m=p[a],e=m.identifier,g.identifier==e?(g=m,d.splice(0,1,m)):n.identifier==e&&(n=m,d.splice(1,1,m));a=n.pageX-g.pageX;e=n.pageY-g.pageY;g=Math.sqrt(a*a+e*e);c.zoomBy(g/f);if(b.preventDefault)b.preventDefault();else return!1};this.handleTouchMove=function(a){return 1==d.length?this.handleOneActiveMove(a):2==d.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=
function(a){e=!0;this.handleMouseMove(a)};this.handleMouseUp=function(a){e=!1};this.handleMouseMove=function(a){e&&c.setScreenX(this.toSVGCoordinates(g,a).x)};this.handleMouseWheel=function(a){var b;a=window.event||a;b=a.deltaY?-a.deltaY:a.wheelDeltaY;c.zoomBy(0<b?2:0.5);if(a.preventDefault)a.preventDefault();else return!1};this.handleXChanged=function(b){b=b.detail;b.source!=a&&c.setX(b.value)}}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.ModelImageEventHandler=function(c,g,d){var e,b,a;this.handleEvent=function(c){var d;d=c.detail.value;c=0;for(nvalues=a.length;c<nvalues&&!(a[c]>d);++c);e.src=b[c]};e=c;b=[];a=[];c=0;for(var f=d.length;c<f;c++)0==c%2?b.push(d[c]):a.push(d[c]);document.addEventListener(g+"Changed",this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.RadialDependancyAdaptor=function(c,g,d,e,b,a){var f,k,r,l,s,m,n,p;this.f=function(a){var b;0==a&&(a=1E-10);b=a*l;a=f.getField(m+b*r,n+b*k,p+a*s);return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])};f=c;m=g;n=d;p=e;k=Math.sin(b);r=Math.cos(b);l=Math.sin(a);s=Math.cos(a)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};(function(f){f.DotRAdapter=function(c,f,d,e,b,a){var h,k,r,l,s,m,n,p,q,u,v;this.f=function(a){var b;0==a&&(a=1E-10);b=a*l;a=h.getField(q+b*r,u+b*k,v+a*s);return a[0]*m+a[1]*n+a[2]*p};h=c;q=f;u=d;v=e;k=Math.sin(b);r=Math.cos(b);l=Math.sin(a);s=Math.cos(a);m=r*l;n=k*l;p=s}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.ModelExpressionEventHandler=function(c,f){var d,e,b,a,h;this.handleEvent=function(b){var c,f;f=b.detail.value;b=0;for(c=a.length;b<c&&!(a[b]>f);++b);MathJax.Hub.Queue(["Text",d,e[b]])};MathJax.Hub.queue.Push(function(){d=MathJax.Hub.getAllJax(c)[0]});d=c;e=[];b=Array.prototype.slice.call(arguments,2);a=[];h=f;for(var k=0,r=b.length;k<r;k++)0==k%2?e.push(b[k]):a.push(b[k]);document.addEventListener(h+"Changed",this.handleEvent.bind(this),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.XvsYView=function(c,g,d,e,b,a,h,k){var r,l,s,m,n,p,q,u,v,A,w,x,t,y,z,B;r=0.1;p=d;q=e;A=1E3/(q-p);x=a;t=h;B=1E3/(t-x);this.getID=function(){return k.id};this.mapXToScreen=function(a){return(a-p)*A};this.mapScreenToX=function(a){return a/A+p};this.mapRawToGroupX=function(a){return a-50};this.mapYToScreen=function(a){a>t?a=t+10:a<x&&(a=x-10);return 1E3-(a-x)*B};this.createPointer=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","use");c.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#pointer");c.setAttributeNS(null,"x",a);c.setAttributeNS(null,"y",b);return c};this.dispatchXChangedEvent=function(){var a;a=document.createEvent("CustomEvent");a.initCustomEvent(g+"Changed",!0,!0,{value:n,source:k.id});k.dispatchEvent(a)};this.setX=function(a){this.x=a;a>=p&&a<=q&&(w=c.f(a),s.x.baseVal.value=this.mapXToScreen(a),s.y.baseVal.value=this.mapYToScreen(w))};this.setScreenX=function(a){a=this.mapRawToGroupX(a);n=this.mapScreenToX(a);n>p&&n<q&&(w=c.f(n),w=this.mapYToScreen(w),s.x.baseVal.value=
a,s.y.baseVal.value=w,this.dispatchXChangedEvent())};this.computePoints=function(){var a,b;m="";for(a=p;a<q;a+=r)b=c.f(a),m+=this.mapXToScreen(a),m+=",",m+=this.mapYToScreen(b),m+=" ";return m=m.substring(0,m.length-1)};this.zoomBy=function(a){var b;p*=a;q*=a;x*=a;t*=a;v.textContent=q.toFixed(2);b=(p+q)/2;u.textContent=b.toFixed(2);z.textContent=t.toFixed(2);b=(x+t)/2;y.textContent=b.toFixed(2);A=1E3/(q-p);B=1E3/(t-x);r*=a;m=this.computePoints();l.setAttributeNS(null,"points",m);n=Math.min(q,Math.max(p,
n));this.setX(n);this.dispatchXChangedEvent()};d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(50,20)");e=document.createElementNS("http://www.w3.org/2000/svg","defs");a=document.createElementNS("http://www.w3.org/2000/svg","clipPath");a.setAttributeNS(null,"id","plotClip");h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttributeNS(null,"x",0);h.setAttributeNS(null,"y",0);h.setAttributeNS(null,"height",1E3);h.setAttributeNS(null,
"width",1E3);a.appendChild(h);e.appendChild(a);h=document.createElementNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"id","pointer");a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttributeNS(null,"cx",0);a.setAttributeNS(null,"cy",0);a.setAttributeNS(null,"r",12);a.setAttributeNS(null,"class","rPointer");h.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttributeNS(null,"cx",0);a.setAttributeNS(null,"cy",0);a.setAttributeNS(null,
"r",5);a.setAttributeNS(null,"class","rPointer");h.appendChild(a);e.appendChild(h);k.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"stroke-width",5);e.setAttributeNS(null,"stroke","black");a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 1000 L 1000 1000 Z");h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M 0 0 L 0 1000 Z");e.appendChild(h);e.appendChild(a);
d.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"class","markers");a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 0 L 1000 0 Z");e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 0 500 L 1000 500 Z");e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 1000 0 L 1000 1000 Z");e.appendChild(a);
a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M 500 0 L 500 1000 Z");e.appendChild(a);z=document.createElementNS("http://www.w3.org/2000/svg","text");z.setAttributeNS(null,"x","-10");z.setAttributeNS(null,"y","10");z.setAttributeNS(null,"class","axisLabel");z.appendChild(document.createTextNode(t));e.appendChild(z);y=document.createElementNS("http://www.w3.org/2000/svg","text");y.setAttributeNS(null,"x","-10");y.setAttributeNS(null,"y","510");y.setAttributeNS(null,
"class","axisLabel");y.appendChild(document.createTextNode((x+t)/2));e.appendChild(y);u=document.createElementNS("http://www.w3.org/2000/svg","text");u.setAttributeNS(null,"x","510");u.setAttributeNS(null,"y","1030");u.setAttributeNS(null,"class","axisLabel");u.appendChild(document.createTextNode((p+q)/2));e.appendChild(u);v=document.createElementNS("http://www.w3.org/2000/svg","text");v.setAttributeNS(null,"x","1010");v.setAttributeNS(null,"y","1030");v.setAttributeNS(null,"class","axisLabel");v.appendChild(document.createTextNode(q));
e.appendChild(v);a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttributeNS(null,"x","-50");a.setAttributeNS(null,"y","510");a.setAttributeNS(null,"transform","rotate(-90 -50,510)");a.setAttributeNS(null,"class","axisLabel");a.appendChild(document.createTextNode(b));e.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttributeNS(null,"x","510");a.setAttributeNS(null,"y","1055");a.setAttributeNS(null,"class","axisLabel");a.appendChild(document.createTextNode(g));
e.appendChild(a);m=this.computePoints();l=document.createElementNS("http://www.w3.org/2000/svg","polyline");l.setAttributeNS(null,"class","curve");l.setAttributeNS(null,"points",m);n=15;w=c.f(n);n=this.mapXToScreen(n);w=this.mapYToScreen(w);s=this.createPointer(n,w);d.appendChild(e);d.appendChild(l);d.appendChild(s);k.appendChild(d);b=new f.LessonControlEventHandler(this,k);k.addEventListener("mousewheel",b.handleMouseWheel.bind(b),!1);k.addEventListener("wheel",b.handleMouseWheel.bind(b),!1);k.addEventListener("mousedown",
b.handleMouseDown.bind(b),!1);document.addEventListener("mouseup",b.handleMouseUp.bind(b),!1);document.addEventListener("mousemove",b.handleMouseMove.bind(b),!1);k.addEventListener("touchstart",b.handleTouchStart.bind(b),!1);k.addEventListener("touchmove",b.handleTouchMove.bind(b),!1);document.addEventListener("touchend",b.handleTouchEnd.bind(b),!1);document.addEventListener(g+"Changed",b.handleXChanged.bind(b),!1)}})(window.vizit.lesson);window.vizit=window.vizit||{};window.vizit.lesson=window.vizit.lesson||{};
(function(f){f.LessonBuilder=function(){this.init=function(){var c,g,d;g=document.getElementsByClassName("lessonElement");for(var e=g.length;e--;)c=g[e],c.hasAttribute("data-type")&&(d=c.getAttribute("data-type").toLowerCase(),"rangedsource"===d?new f.RangedSource(c):"setter"===d&&new f.Setter(c))};this.initWhenReady=function(){"interactive"===document.readyState||"complete"===document.readyState?this.init():document.addEventListener("DOMContentLoaded",this.findElements,!1)}};(new f.LessonBuilder).initWhenReady()})(window.vizit.lesson);
